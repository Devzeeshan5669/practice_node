let menus = [
    {
        id: 81,
        name: "Artists",
        category: "artists",
        icon: "icon-microphone",
        has_child: 0,
        created_at: "2017-12-28 11:09:05",
        updated_at: "2022-07-21 09:13:00",
        parent_id: 80,
        type: null,
        image: null,
        number: 0
    },
    {
        id: 115,
        name: "testing",
        category: "none",
        icon: null,
        has_child: 0,
        created_at: "2023-02-20 11:54:58",
        updated_at: "2023-02-20 11:54:58",
        parent_id: 96,
        type: null,
        image: null,
        number: 0
    },
    {
        id: 114,
        name: "asdad",
        category: null,
        icon: null,
        has_child: 0,
        created_at: "2023-02-17 14:02:42",
        updated_at: "2023-02-17 14:02:42",
        parent_id: 81,
        type: null,
        image: null,
        number: 0
    },
    {
        id: 113,
        name: "menu 4",
        category: null,
        icon: null,
        has_child: 0,
        created_at: "2023-02-17 14:00:19",
        updated_at: "2023-02-17 14:00:19",
        parent_id: 107,
        type: null,
        image: null,
        number: 0
    },
    {
        id: 111,
        name: "labelsubmenu2",
        category: "none",
        icon: "icon-tag-multiple",
        has_child: 1,
        created_at: "2023-02-17 12:00:26",
        updated_at: "2023-02-17 12:00:26",
        parent_id: 96,
        type: null,
        image: null,
        number: 0
    },
    {
        id: 110,
        name: "Menu3",
        category: null,
        icon: null,
        has_child: 0,
        created_at: "2023-02-17 10:33:19",
        updated_at: "2023-02-17 10:33:19",
        parent_id: 107,
        type: null,
        image: null,
        number: 0
    },
    {
        id: 109,
        name: "Menu2",
        category: null,
        icon: null,
        has_child: 0,
        created_at: "2023-02-17 10:32:33",
        updated_at: "2023-02-17 10:32:33",
        parent_id: 107,
        type: null,
        image: null,
        number: 0
    },
    {
        id: 96,
        name: "Labels",
        category: null,
        icon: "icon-star-outline",
        has_child: 0,
        created_at: "2022-11-08 10:36:43",
        updated_at: "2023-02-20 11:28:07",
        parent_id: 0,
        type: null,
        image: null,
        number: 0
    },
    {
        id: 83,
        name: "Tracks",
        category: "tracks",
        icon: "icon-plus",
        has_child: 0,
        created_at: "2017-12-28 11:09:36",
        updated_at: "2022-07-21 09:13:22",
        parent_id: 80,
        type: null,
        image: null,
        number: 0
    },
    {
        id: 82,
        name: "Albums",
        category: "albums",
        icon: "icon-disk-alert",
        has_child: 0,
        created_at: "2017-12-28 11:09:23",
        updated_at: "2022-07-18 15:32:36",
        parent_id: 80,
        type: null,
        image: null,
        number: 0
    },
    {
        id: 93,
        name: "Trending",
        category: "artists",
        icon: "icon-trending-up",
        has_child: 0,
        created_at: "2022-08-09 05:29:50",
        updated_at: "2023-02-20 11:28:08",
        parent_id: 0,
        type: null,
        image: null,
        number: 1
    },
    {
        id: 84,
        name: "Featured",
        category: "artists",
        icon: "icon-star",
        has_child: 0,
        created_at: "2022-07-21 09:14:05",
        updated_at: "2023-02-20 11:28:08",
        parent_id: 0,
        type: null,
        image: null,
        number: 2
    },
    {
        id: 92,
        name: "Sponsored Artists",
        category: "artists",
        icon: "icon-bullhorn",
        has_child: 0,
        created_at: "2022-08-02 19:57:14",
        updated_at: "2023-02-20 11:28:08",
        parent_id: 0,
        type: null,
        image: null,
        number: 3
    },
    {
        id: 88,
        name: "Pre-Order Projects",
        category: "albums",
        icon: "icon-cart",
        has_child: 0,
        created_at: "2022-07-25 23:07:30",
        updated_at: "2023-02-20 11:28:08",
        parent_id: 0,
        type: null,
        image: null,
        number: 4
    },
    {
        id: 89,
        name: "Unlocked Music",
        category: "artists",
        icon: "icon-lock-unlocked",
        has_child: 0,
        created_at: "2022-07-26 07:49:47",
        updated_at: "2023-02-20 11:28:08",
        parent_id: 0,
        type: null,
        image: null,
        number: 5
    },
    {
        id: 90,
        name: "Artists With Stores",
        category: "stores",
        icon: "icon-wallet-giftcard",
        has_child: 0,
        created_at: "2022-08-02 17:50:01",
        updated_at: "2023-02-20 11:28:08",
        parent_id: 0,
        type: null,
        image: null,
        number: 6
    },
    {
        id: 95,
        name: "Artists You Can Tip",
        category: "artists",
        icon: "icon-android",
        has_child: 0,
        created_at: "2022-08-25 01:58:31",
        updated_at: "2023-02-20 11:28:08",
        parent_id: 0,
        type: null,
        image: null,
        number: 7
    },
    {
        id: 80,
        name: "Indie Artists",
        category: "none",
        icon: "icon-heart",
        has_child: 1,
        created_at: "2017-12-28 11:08:37",
        updated_at: "2023-02-20 11:28:08",
        parent_id: 0,
        type: null,
        image: null,
        number: 8,
        children: []
    }
]

const refactorMenus = (menus) => {
    const nested = menus.reduce((initial, value, index, original) => {
        // console.log(initial)
        if (value.parent_id == 0) {
            if (initial.left.length) {
                checkLeftOvers(initial.left, value)
            }
            initial.nested.push(value)
        } else {
            let parentFound = findParent(initial.nested, value)
            if (parentFound) {
                checkLeftOvers(initial.left, value)
            } else {
                initial.left.push(value)
            }
        }
        return index < original.length - 1 ? initial : initial.nested
    }, { nested: [], left: [] })
    return nested;
}


const checkLeftOvers = (leftOvers, possibleParent) => {
    // console.log(leftOvers, possibleParent)
    for (let i = 0; i < leftOvers.length; i++) {
        if (leftOvers[i].parent_id === possibleParent.id) {
            possibleParent.children ? possibleParent.children.push(leftOvers[i]) : possibleParent.children = [leftOvers[i]]
            possibleParent.count = possibleParent.children.length
            const addedObj = leftOvers.splice(i, 1)
            checkLeftOvers(leftOvers, addedObj[0])
        }
    }
}

const findParent = (possibleParents, possibleChild) => {
    // getOriginalParent()
    let found = false
    for (let i = 0; i < possibleParents.length; i++) {
        if (possibleParents[i].id == possibleChild.parent_id) {
            found = true
            if (possibleParents[i].children) possibleParents[i].children.push(possibleChild)
            else possibleParents[i].children = [possibleChild]
            possibleParents[i].count = possibleParents[i].children.length
            return true
        } else if (possibleParents[i].children) found = findParent(possibleParents[i].children, possibleChild)
    }
    return found;
}


console.log(refactorMenus(menus))
// refactorMenus(menus)